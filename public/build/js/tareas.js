!function(){const e=document.querySelector("#agregar-tarea"),t={0:"Pendiente",1:"Completa"},a=(e=!1,t=null)=>{const a=document.createElement("DIV");a.classList.add("modal"),a.innerHTML=` \n            <form class="formulario nueva-tarea">\n                <legend>${e?"Edita el nombre de la tarea":"A単ande una nueva tarea"}</legend>\n                <div class="campo">\n                    <label for="tarea">Tarea</label>\n                    <input\n                        type="text"\n                        name="tarea"\n                        id="tarea"\n                        placeholder="${e?"Nuevo nombre":"Nueva tarea al proyecto"}"\n                        value="${e?t.nombre:""}"\n                    />\n                </div>\n                <div class="opciones">\n                    <button type="button" class="submit-nueva-tarea">${e?"Editar nombre":"A単adir tarea"}</button>\n                    <button type="button" class="cerrar-modal" value="A単adir tarea">Cancelar</button>\n\n                </div>\n            </form>\n        `,document.querySelector(".dashboard").appendChild(a);const r=document.querySelector("#tarea"),c=document.querySelector(".formulario");setTimeout((()=>{c.classList.add("animar")}),0),a.addEventListener("click",(async s=>{if(s.preventDefault(),(s.target.classList.contains("modal")||s.target.classList.contains("cerrar-modal"))&&(c.classList.remove("animar"),setTimeout((()=>a.remove()),300)),s.target.classList.contains("submit-nueva-tarea")){const s=r.value.trim();if(!s)return void n("El nombre es obligatorio","error",c.querySelector(".campo"));e?(async e=>{try{const t=new FormData;t.append("id",e.id),t.append("nombre",e.nombre),t.append("proyectoId",o());const a=await fetch("/api/tarea/nombre",{method:"POST",body:t}),r=await a.json();if(200!==a.status)return n(r.mensaje,"error",document.querySelector(".contenido .contenedor-nueva-tarea"),6);document.querySelector(`.tarea[data-id="${e.id}"] p`).textContent=e.nombre}catch(e){return console.log(e),n("Algo salio mal, intentelo de nuevo, si el problema persiste contacte al soporte","error",document.querySelector(".contenido .contenedor-nueva-tarea"),6)}})({id:t.id,nombre:s}):d(s),c.classList.remove("animar"),setTimeout((()=>{a.remove()}),300)}}))},n=(e,t,a,n=3e3)=>{const o=document.createElement("DIV");o.classList.add("alerta",t),o.textContent=e,a.insertAdjacentElement("beforebegin",o),setTimeout((()=>o.remove()),1e3*n)},o=()=>{const e=new URLSearchParams(window.location.search),{id:t}=Object.fromEntries(e.entries());return t},r=async e=>{try{const t=new FormData;t.append("id",e.id),t.append("proyectoId",e.proyectoId);const a=await fetch("/api/tarea/eliminar",{method:"POST",body:t}),o=await a.json();if(200!==a.status)return n(o.mensaje,"error",document.querySelector(".contenido .contenedor-nueva-tarea"),6);document.querySelector(`.tarea[data-id="${e.id}"]`).remove(),console.log(o)}catch(e){console.log(e),n("Algo salio mal, intentelo de nuevo, si el problema persiste contacte al soporte","error",document.querySelector(".contenido .contenedor-nueva-tarea"),6)}},c=(e,c)=>{const d=document.createElement("LI");d.dataset.id=e.id,d.classList.add("tarea");const i=document.createElement("P");i.textContent=e.nombre,i.addEventListener("dblclick",(async t=>{a(!0,{id:e.id,nombre:e.nombre});const n="/api/tareas?id="+o(),r=await fetch(n),c=await r.json();if(200!==r.status)return;const{tareas:d}=c;s(d)}));const l=document.createElement("DIV");l.classList.add("opciones");const u=document.createElement("BUTTON");u.classList.add("estado-tarea",`${t[e.estado].toLowerCase()}`),u.dataset.estado=e.estado,u.dataset.id=e.id,u.textContent=t[e.estado],u.addEventListener("dblclick",(async a=>{const o=await(async e=>{const t=new FormData;t.append("nombre",e.nombre),t.append("id",e.id),t.append("proyectoId",e.proyectoId);try{const e=await fetch("/api/tarea/actualizar",{method:"POST",body:t}),a=await e.json();return 200!==e.status?(n(a.mensaje,"error",document.querySelector(".contenido .contenedor-nueva-tarea"),6),null):a.estado}catch(e){return n("Algo salio mal, intentelo de nuevo, si el problema persiste contacte al soporte","error",document.querySelector(".contenido .contenedor-nueva-tarea"),6),null}})(e);if(null===o)return;const r=0===o?1:0;u.classList.remove(`${t[r].toLowerCase()}`),u.classList.add(`${t[o].toLowerCase()}`),u.textContent=t[o]}));const m=document.createElement("BUTTON");m.classList.add("eliminar-tarea"),m.dataset.id=e.id,m.textContent="Eliminar",m.addEventListener("click",(t=>{(e=>{Swal.fire({title:"多Eliminar tarea?",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No",width:"350px"}).then((t=>{t.isConfirmed&&(Swal.fire("Tarea Eliminada","","success"),r(e))}))})(e)})),l.append(u,m),d.append(i,l),c.append(d)},s=e=>{const t=document.querySelector("#listado-tareas");if(0===e.length){const e=document.createElement("LI");return e.textContent="No hay tareas",e.classList.add("no-tareas"),void t.append(e)}t.innerHTML="",e.forEach((e=>{c(e,t)}))};!async function(){try{const e="/api/tareas?id="+o(),t=await fetch(e),a=await t.json();if(200!==t.status)return;const{tareas:n}=a;s(n)}catch(e){}}();const d=async e=>{const t=new FormData;t.append("nombre",e),t.append("url",o());try{const e=await fetch("/api/tarea",{method:"POST",body:t}),a=await e.json();if(201!==e.status)return n(a.mensaje,"error",document.querySelector(".contenido .contenedor-nueva-tarea"),6);const{datos:o}=a;c(o,document.querySelector("#listado-tareas"))}catch(e){n("Algo salio mal, intentelo de nuevo, si el problema persiste contacte al soporte","error",document.querySelector(".contenido .contenedor-nueva-tarea"),6)}};e.addEventListener("click",(e=>{a()}))}();